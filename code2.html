<!DOCTYPE html>
<html lang="es" class="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DavGenerator Analyzer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
    />
    <link rel="icon" href="nodos-de-ia.png" type="image/x-icon" />
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/highlight.min.js"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/styles/atom-one-dark.min.css"
    />
    <script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              dark: {
                100: "#1E2028",
                200: "#2D303E",
                300: "#3C4051",
              },
            },
            animation: {
              gradient: "gradient 15s ease infinite",
            },
            keyframes: {
              gradient: {
                "0%, 100%": {
                  "background-size": "200% 200%",
                  "background-position": "left center",
                },
                "50%": {
                  "background-size": "200% 200%",
                  "background-position": "right center",
                },
              },
            },
          },
        },
      };
    </script>
    <style>
      .gradient-bg {
        background: linear-gradient(-45deg, #1e2028, #2d303e, #3c4051, #4b5066);
        background-size: 400% 400%;
        animation: gradient 15s ease infinite;
      }
      @keyframes gradient {
        0% {
          background-position: 0% 50%;
        }
        50% {
          background-position: 100% 50%;
        }
        100% {
          background-position: 0% 50%;
        }
      }
    </style>
  </head>
  <body class="bg-dark-100 text-gray-200 min-h-screen flex flex-col">
    <nav class="bg-dark-300 shadow-lg gradient-bg animate-gradient">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between h-16">
          <div class="flex items-center">
            <a href="#" class="flex-shrink-0 flex items-center">
              <img class="h-8 w-auto" src="imagen.png" alt="DavC Logo" />
              <span
                class="ml-2 text-xl font-bold text-blue-400 animate__animated animate__fadeIn"
                >DavC Analyzer</span
              >
            </a>
          </div>
          <div class="flex items-center space-x-4">
            <a
              href="index.html"
              class="text-gray-300 hover:bg-dark-200 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition duration-300 ease-in-out animate__animated animate__fadeIn"
              >Home</a
            >
            <a
              href="#"
              class="text-gray-300 hover:bg-dark-200 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition duration-300 ease-in-out animate__animated animate__fadeIn animate__delay-1s"
              >Analyzer</a
            >
          </div>
        </div>
      </div>
    </nav>

    <main class="flex-grow flex items-center justify-center p-4">
      <div class="container mx-auto px-4">
        <div
          class="bg-dark-200 bg-opacity-80 backdrop-filter backdrop-blur-lg rounded-lg shadow-2xl p-8 max-w-2xl mx-auto animate__animated animate__fadeIn"
        >
          <h1
            class="text-4xl font-bold mb-6 text-center text-blue-400 animate__animated animate__pulse animate__infinite"
          >
            DavAnalyzer
          </h1>
          <div class="mb-6">
            <label for="inputQuestion" class="block text-gray-300 mb-2 text-lg">
              Escribe tu Pseudoc√≥digo para encontrar errores l√≥gicos, de
              sintaxis, etc.
            </label>
            <textarea
              id="inputQuestion"
              class="w-full p-4 text-lg bg-dark-300 rounded-lg border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-300 ease-in-out resize-y min-h-[150px]"
              placeholder="Escribe la descripci√≥n del c√≥digo aqu√≠..."
            ></textarea>
          </div>
          <div class="flex space-x-4">
            <button
              id="submitButton"
              class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 animate__animated animate__pulse animate__infinite"
            >
              Analizar
            </button>
            <button
              id="learnModeButton"
              class="flex-1 bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded-lg transition duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 animate__animated animate__pulse animate__infinite"
            >
              Modo Aprendizaje
            </button>
          </div>
          <div class="mt-6">
            <label for="responseText" class="block text-gray-300 mb-2 text-lg">
              Respuesta del An√°lisis:
            </label>
            <div
              id="responseText"
              class="w-full p-4 text-lg bg-dark-300 rounded-lg border border-gray-600 min-h-[200px] max-h-[400px] overflow-y-auto focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-300 ease-in-out prose prose-invert"
            >
              El an√°lisis del c√≥digo aparecer√° aqu√≠...
            </div>
          </div>
        </div>
      </div>
    </main>

    <footer
      class="mt-8 text-center text-gray-400 animate__animated animate__fadeInUp p-4"
    >
      <p>Creado por <span class="font-bold text-blue-400">DavC</span></p>
      <p class="mt-2">&copy; 2024 - Sin nada que Hacer</p>
    </footer>

    <!-- Modal d-->
    <div
      id="cooldownModal"
      class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center"
    >
      <div class="bg-dark-200 p-8 rounded-lg shadow-xl max-w-md w-full">
        <h2 class="text-2xl font-bold mb-4 text-blue-400">
          ¬°Ey ey ey, m√°s despacio!
        </h2>
        <p class="mb-4">
          Vas a saturar el modelo. <br />
          Espera un poco *10 segundos*
        </p>
        <img
          src="anime.gif"
          alt="Anime GIF"
          class="w-full h-auto mb-4 rounded"
          style="width: 100px"
        />
        <button
          id="closeModal"
          class="bg-pink-700 hover:bg-red-700 text-white font-bold py-2 px-4 rounded"
        >
          Oki
        </button>
      </div>
    </div>

    <script type="module">
      import { GoogleGenerativeAI } from "https://esm.run/@google/generative-ai";

      const API_KEY = "AIzaSyBFwb4V-OJrWNoJmBob26E4JCsVjvSQiUE";
      const genAI = new GoogleGenerativeAI(API_KEY);

      // Modelo para an√°lisis general
      const model = genAI.getGenerativeModel({
        model: "gemini-1.5-pro",
        systemInstruction: `
  You are a bot specialized in Pseudocode and Pseint. Always provide your answers in Spanish.
  Your primary task is to review pseudocode and provide a complete analysis. If the user provides
  valid pseudocode, follow this process:
  - Use Markdown and code formatting where necessary
  Review Format:
  Presentacion: "**Hola soy DavBot**üíª"

  1. Qu√© hace el Programa: [explain what it does]
  2. Errores de L√≥gica: [If there are any, write down the errors; otherwise, state that it's fine]
  3. Sign off with '**DavBot ha terminado su trabajo**ü¶â'

  If the input provided by the user is not related to pseudocode:
  1. Respond with: "Lo siento, solo fui entrenado para revisar pseudoc√≥digo en Pseint y no puedo responder otras preguntas. '2 line break' \nComunicate con David Si quieres M√°s informacion de como me entreno (‚óè'‚ó°'‚óè)"

  2. Do not provide any further response beyond this.
  `,
        temperature: 0.4,
      });

      // Modelo para Modo Aprendizaje
      const learnModel = genAI.getGenerativeModel({
        model: "gemini-1.5-pro",
        systemInstruction: `
  You are a teaching assistant specialized in Pseudocode and Pseint. Always provide your explanations in Spanish.
  Your task is to break down the pseudocode provided by the user into detailed, step-by-step blocks, explaining each part
  in an easy-to-understand manner.
  - Use Markdown and code formatting where necessary
  Explanation Format:
  1. Descripci√≥n paso a paso del pseudoc√≥digo.
  2. Explicaci√≥n detallada de cada bloque de c√≥digo.
  3. Ejemplos adicionales si es necesario.

  Make sure the explanation is clear and accessible for beginners.

  If the input provided by the user is not related to pseudocode:
  1. Respond with: "Amigo entiende, solo fui entrenado para Explicar codigo en este modo, no para platicar. '2 line break' \n Pronto estara un chatbot para que puedas platicar (‚óè'‚ó°'‚óè)"

  2. Do not provide any further response beyond this.
  `,
        temperature: 0.5,
      });

      function renderMarkdown(text) {
        const htmlContent = marked.parse(text);
        const tempDiv = document.createElement("div");
        tempDiv.innerHTML = htmlContent;

        tempDiv.querySelectorAll("pre code").forEach((block) => {
          hljs.highlightElement(block);
        });

        return tempDiv.innerHTML;
      }

      const submitButton = document.getElementById("submitButton");
      const learnModeButton = document.getElementById("learnModeButton");
      const cooldownModal = document.getElementById("cooldownModal");
      const closeModal = document.getElementById("closeModal");

      let lastClickTime = 0;
      const cooldownTime = 10000; // 10 segundos en milisegundos

      function showCooldownModal() {
        cooldownModal.classList.remove("hidden");
        cooldownModal.classList.add("flex");
      }

      function hideCooldownModal() {
        cooldownModal.classList.add("hidden");
        cooldownModal.classList.remove("flex");
      }

      closeModal.addEventListener("click", hideCooldownModal);

      async function handleButtonClick(modelFunction) {
        const currentTime = Date.now();
        if (currentTime - lastClickTime < cooldownTime) {
          showCooldownModal();
          return;
        }

        lastClickTime = currentTime;
        const description = document.getElementById("inputQuestion").value;
        const responseText = document.getElementById("responseText");

        if (description.trim() === "") {
          alert("Por favor, ingresa una descripci√≥n del c√≥digo.");
          return;
        }

        responseText.innerHTML =
          '<div class="animate-pulse">Procesando, este modo puede tardar un poco por el analisis...No presionar nuevamente, espere </div>';

        try {
          const result = await modelFunction.generateContent(description);
          const markdownText = result.response.text();
          responseText.innerHTML = renderMarkdown(markdownText);
          responseText.classList.add("animate__animated", "animate__fadeIn");
        } catch (error) {
          console.error("Error generando el contenido:", error);
          responseText.textContent = "Error generando el contenido.";
        }
      }

      submitButton.addEventListener("click", () => handleButtonClick(model));
      learnModeButton.addEventListener("click", () =>
        handleButtonClick(learnModel)
      );
    </script>
  </body>
</html>
